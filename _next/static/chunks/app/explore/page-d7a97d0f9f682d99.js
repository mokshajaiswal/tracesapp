(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[314],{62:(e,t,a)=>{"use strict";a.d(t,{A:()=>x});var s=a(5155);let r=(0,a(9946).A)("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]);var l=a(492),n=a(7580),i=a(6766),o=a(6048);function c(e,t){if(!e)return"";let a=e.split(" ");return a.length>t?a.slice(0,t).join(" ")+"...":e}function d(e){let{type:t}=e,a={image:"/attachment/image.png",video:"/attachment/video.png",audio:"/attachment/audio.png",note:"/attachment/note.png"}[t];return a?(0,s.jsx)(i.default,{src:"".concat("/tracesapp").concat(a),alt:"".concat(t," icon"),width:25,height:25,className:"object-contain drop-shadow pb-1"}):null}function x(e){let{onClick:t,title:a,subtitle:i,hashtags:x,distance:h,theme:m="pink",titleWordLimit:u,subtitleWordLimit:g,attachmentIcons:p=[],totalAttachments:f,author:b,isFriend:j}=e,v=u?c(a,u):a,w=g?c(i,g):i,y=(0,o.BO)(h),N={pink:{container:"bg-pink-50 border-pink-200",pill:"bg-white/80 border-pink-200 text-pink-800",hashtag:"bg-pink-100/80 text-pink-800"},blue:{container:"bg-blue-50 border-blue-200",pill:"bg-white/80 border-blue-200 text-blue-800",hashtag:"bg-blue-100/80 text-blue-800"},green:{container:"bg-green-50 border-green-200",pill:"bg-white/80 border-green-200 text-green-800",hashtag:"bg-green-100/80 text-green-800"},orange:{container:"bg-orange-50 border-orange-200",pill:"bg-white/80 border-orange-200 text-orange-800",hashtag:"bg-orange-100/80 text-orange-800"}},k=N[m]||N.pink;return(0,s.jsxs)("button",{onClick:t,className:"flex flex-col p-5 space-y-2 rounded-3xl border text-left ".concat(k.container),children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsx)("div",{className:"flex items-center h-[34px] ".concat(2!==f?"space-x-1.5":"w-10"),children:0===f?(0,s.jsx)(r,{size:20,className:"text-slate-500"}):2===f&&2===p.length?(0,s.jsx)("div",{className:"relative w-10 h-10 flex items-center justify-center",children:p.map((e,t)=>(0,s.jsx)("div",{className:"absolute transition-transform duration-300 \n                ".concat(0===t?"-rotate-[15deg] z-10 -translate-x-1.5":"rotate-[15deg] z-0 translate-x-1.5"),children:(0,s.jsx)(d,{type:e})},e))}):f>3?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"text-sm font-semibold text-slate-600",children:f}),(0,s.jsx)(l.A,{size:16,className:"text-slate-500"})]}):p.map(e=>(0,s.jsx)(d,{type:e},e))}),"..."!==y&&(0,s.jsx)("div",{className:"px-3 py-1 text-xs font-medium rounded-full border ".concat(k.pill," -mr-2"),children:y})]}),(0,s.jsxs)("div",{className:"flex flex-col space-y-1 flex-grow mt-2",children:[b&&(0,s.jsxs)("div",{className:"flex items-center gap-1.5 text-xs font-medium text-gray-500 mb-1",children:[(0,s.jsxs)("span",{children:["By ",b]}),j&&(0,s.jsx)(n.A,{size:14,className:"text-blue-500"})]}),(0,s.jsx)("h2",{className:"text-[1.05rem] font-bold text-slate-800 tracking-normal",children:v}),(0,s.jsx)("p",{className:"text-sm text-slate-500 leading-relaxed",children:w})]}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mt-4",children:x.slice(0,3).map(e=>(0,s.jsx)("span",{className:"inline-block px-2.5 py-1 text-xs font-semibold rounded-full ".concat(k.hashtag),children:e},e))})]})}},492:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("paperclip",[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]])},2870:(e,t,a)=>{Promise.resolve().then(a.bind(a,5042))},5042:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>z});var s=a(5155),r=a(2115),l=a(5695),n=a(2200),i=a(2501),o=a(6766),c=a(6341);function d(e){let{userName:t,onRecenterClick:a}=e;return(0,s.jsxs)("div",{className:"flex items-center justify-between pt-2",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)(o.default,{src:"".concat("/tracesapp","/tracelogo.png"),alt:"Traces Logo",width:35,height:36,className:"rounded-full pt-1"}),(0,s.jsxs)("p",{className:"text-lg font-bold text-gray-800",children:["Hello ",t]})]}),(0,s.jsx)("button",{onClick:a,className:"p-2 rounded-full hover:bg-gray-100 transition-colors","aria-label":"Recenter map to your location",children:(0,s.jsx)(c.A,{size:24,className:"text-gray-600"})})]})}var x=a(6874),h=a.n(x);let m=(0,a(9946).A)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);function u(){return(0,s.jsx)(h(),{href:"/explore/all",children:(0,s.jsx)("div",{className:"flex items-center justify-center p-4 rounded-3xl border-2 border-dashed border-gray-300 bg-gray-50 hover:bg-gray-100 hover:border-gray-400 transition-all h-28",children:(0,s.jsxs)("div",{className:"text-center font-semibold text-gray-600",children:[(0,s.jsx)("p",{children:"View All"}),(0,s.jsx)(m,{className:"mx-auto mt-1",size:20})]})})})}var g=a(62),p=a(4631),f=a(6656),b=a(760),j=a(8274),v=a(8706),w=a(3418),y=a(6048);function N(){return(0,s.jsxs)("button",{className:"flex items-center gap-1 text-xs font-normal text-gray-600 hover:text-gray-900 transition-colors",children:[(0,s.jsx)("span",{children:"Know More"}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-[1.1rem] h-[1.1rem] rounded-full bg-pink-200 border-2 border-white"}),(0,s.jsx)("div",{className:"w-[1.1rem] h-[1.1rem] rounded-full bg-blue-300 border-2 border-white -ml-2"}),(0,s.jsx)("div",{className:"w-[1.1rem] h-[1.1rem] rounded-full bg-green-200 border-2 border-white -ml-2"})]})]})}let k={width:"100%",height:"100%"},S={lat:52.668,lng:-8.6305};function z(){let{isLoaded:e}=(0,i.n)(),{userName:t}=(0,w.J)(),{scrollToTop:a,refreshId:c,unlockedTraceIds:x,userLocation:h}=(0,v.r)(),[m,z]=(0,r.useState)(null),[C,A]=(0,r.useState)(null),[_,T]=(0,r.useState)(!1),[E,F]=(0,r.useState)(!0),[M,I]=(0,r.useState)(!0),[L,O]=(0,r.useState)([]),B=(0,l.useSearchParams)();(0,r.useEffect)(()=>{let e=JSON.parse(localStorage.getItem(f.rV)||"[]");O([...f.Tf,...e])},[c]),(0,r.useEffect)(()=>{m&&h&&E&&m.panTo(h)},[m,h,E]),(0,r.useEffect)(()=>{if(L.length>0&&!C){let e=B.get("openTrace");if(e){let t=L.find(t=>t.id.toString()===e);t&&(I(!1),A(t))}}},[B,L,C]),(0,r.useEffect)(()=>{let e=e=>{var t;(null==(t=e.state)?void 0:t.traceId)||A(null)};return window.addEventListener("popstate",e),()=>{window.removeEventListener("popstate",e)}},[]);let P=e=>{I(!0),A(e),history.pushState({traceId:e.id},"","?openTrace=".concat(e.id))},U=(0,r.useCallback)(e=>{z(e),h?e.setCenter(h):e.setCenter(S)},[h]),Y=(0,r.useMemo)(()=>L.filter(e=>!x.includes(e.id)&&e.author!==t).sort((e,t)=>(h?(0,y.Yf)(h,e.location):0)-(h?(0,y.Yf)(h,t.location):0)),[L,x,h,t]),R=e=>{let a=h?(0,y.Yf)(h,e.location):null,{attachmentIcons:r,totalAttachments:l}=(0,y.KL)(e.attachments),n=e.author===t,i=f.QS.includes(e.author),o="blue";return n?o="orange":e.isPrivate?o="pink":i&&(o="green"),(0,s.jsx)(g.A,{onClick:()=>P(e),title:e.title,subtitle:e.description?e.description.substring(0,100):"",hashtags:e.hashtags||[],distance:a,titleWordLimit:4,subtitleWordLimit:8,author:e.author,attachmentIcons:r,totalAttachments:l,theme:o,isFriend:i},e.id)},q=Y.filter((e,t)=>t%2==0),D=Y.filter((e,t)=>t%2!=0);return(0,s.jsxs)("div",{className:"relative overflow-x-hidden",children:[(0,s.jsx)("div",{className:"relative z-10 bg-white shadow-[0_5px_15px_rgba(0,0,0,0.08)] rounded-b-3xl px-4 py-3 overflow-x-hidden",children:(0,s.jsx)(d,{userName:t,onRecenterClick:()=>{m&&h&&(m.panTo(h),F(!0))}})}),(0,s.jsx)("div",{className:"-mt-6 transition-all duration-300 ease-in-out ".concat(_?"h-[65vh]":"h-[40vh]"),children:e&&(0,s.jsxs)(n.u6,{mapContainerStyle:k,zoom:18,options:{disableDefaultUI:!0,zoomControl:!1},onLoad:U,onDragStart:()=>{T(!0),F(!1),a()},onDragEnd:()=>{T(!1)},children:[Y.map(e=>{let a=(0,y.hS)(e,t,f.QS);return(0,s.jsx)(n.X0,{position:e.location,onClick:()=>P(e),icon:{url:"data:image/svg+xml;charset=UTF-8,".concat(encodeURIComponent(a)),scaledSize:new window.google.maps.Size(40,40)}},e.id)}),h&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.T$,{center:h,radius:10,options:{strokeColor:"#4285F4",strokeOpacity:.8,strokeWeight:2,fillColor:"#4285F4",fillOpacity:.2}}),(0,s.jsx)(n.X0,{position:h,icon:{url:"data:image/svg+xml;charset=UTF-8,".concat(encodeURIComponent('<svg width="24" height="24" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="40" fill="%234285F4" stroke="white" stroke-width="8"/></svg>')),scaledSize:new window.google.maps.Size(24,24),anchor:new window.google.maps.Point(12,12)}})]})]})}),(0,s.jsxs)("div",{className:"relative bg-white p-4 rounded-t-3xl -mt-6 shadow-[0_-5px_15px_rgba(0,0,0,0.1)] overflow-x-hidden",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center px-3 mt-2 mb-6",children:[(0,s.jsx)(o.default,{src:"".concat("/tracesapp","/title.svg"),alt:"Traces Near You Title",width:135,height:14}),(0,s.jsx)(N,{})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)("div",{className:"flex flex-col space-y-4",children:q.map(R)}),(0,s.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,s.jsx)(u,{}),D.map(R)]})]})]}),(0,s.jsx)(b.N,{children:C&&(()=>{let e=h?(0,y.Yf)(h,C.location):null,t=f.QS.includes(C.author),a={...C,distance:(0,y.BO)(e),isFriend:t};return(0,s.jsx)(j.P.div,{className:"fixed inset-0 z-50 bg-white",initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"tween",ease:[.1,.1,.1,1],duration:.5*!!M},children:(0,s.jsx)(p.A,{trace:a,onBack:()=>history.back()})})})()})]})}},7580:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])}},e=>{e.O(0,[84,831,367,413,117,966,874,631,441,964,358],()=>e(e.s=2870)),_N_E=e.O()}]);